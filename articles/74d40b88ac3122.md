---
title: "ç¢ºç‡å¯†åº¦é–¢æ•°ã®ç•³ã¿è¾¼ã¿ã«ã¤ã„ã¦"
emoji: "ğŸ¤–"
type: "tech"
topics:
  - "çµ±è¨ˆå­¦"
published: true
published_at: "2024-11-21 16:34"
---

# å®šç†
$X, Y$ ãŒç‹¬ç«‹ã§ã€ãã‚Œãã‚Œå¯†åº¦é–¢æ•° $f_X(x), f_Y(y)$ ã‚’ã‚‚ã¤ã¨ãã€ $U=X+Y$ ã®å¯†åº¦é–¢æ•°ã¯ã€æ¬¡å¼ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚

$$
g(u) = \int_{-\infty}^{+\infty}f_X(x)f_Y(u-x)dx
$$

ã“ã®å¼ã¯ç•³ã¿è¾¼ã¿ã¨å‘¼ã°ã‚Œã‚‹ã€‚

Pythonã«ã‚ˆã‚‹è¦–è¦šçš„èª¬æ˜ã€‚
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import norm
from scipy.integrate import quad

def f_X(x, mu1=0, sigma1=1):
    """X ã®ç¢ºç‡å¯†åº¦é–¢æ•° (æ­£è¦åˆ†å¸ƒ)"""
    return norm.pdf(x, mu1, sigma1)

def f_Y(y, mu2=0, sigma2=1):
    """Y ã®ç¢ºç‡å¯†åº¦é–¢æ•° (æ­£è¦åˆ†å¸ƒ)"""
    return norm.pdf(y, mu2, sigma2)

def convolution_integral(u, mu1=0, sigma1=1, mu2=0, sigma2=1):
    """ç•³ã¿è¾¼ã¿ç©åˆ†ã‚’è¨ˆç®—"""
    integrand = lambda x: f_X(x, mu1, sigma1) * f_Y(u-x, mu2, sigma2)
    result, _ = quad(integrand, -np.inf, np.inf)
    return result

def theoretical_sum_normal(x, mu1=0, sigma1=1, mu2=0, sigma2=1):
    """2ã¤ã®æ­£è¦åˆ†å¸ƒã®å’Œã®ç†è«–çš„ãªç¢ºç‡å¯†åº¦é–¢æ•°"""
    mu = mu1 + mu2
    sigma = np.sqrt(sigma1**2 + sigma2**2)
    return norm.pdf(x, mu, sigma)

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
mu1, sigma1 = 1, 1  # X ã®å¹³å‡ã¨æ¨™æº–åå·®
mu2, sigma2 = 2, 1.5  # Y ã®å¹³å‡ã¨æ¨™æº–åå·®

# è¨ˆç®—ç¯„å›²ã®è¨­å®š
u = np.linspace(-2, 8, 100)

# ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ç¢ºç‡å¯†åº¦é–¢æ•°ã®è¨ˆç®—
g_numerical = [convolution_integral(ui, mu1, sigma1, mu2, sigma2) for ui in u]

# ç†è«–å€¤ã®è¨ˆç®—
g_theoretical = theoretical_sum_normal(u, mu1, sigma1, mu2, sigma2)

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
plt.plot(u, g_numerical, 'b-', label='Numerical Convolution')
plt.plot(u, g_theoretical, 'r--', label='Theoretical')
plt.plot(u, [f_X(x, mu1, sigma1) for x in u], 'g:', label='X density')
plt.plot(u, [f_Y(y, mu2, sigma2) for y in u], 'm:', label='Y density')
plt.xlabel('u')
plt.ylabel('Probability Density')
plt.title('Density Function of Sum of Independent Normal Distributions')
plt.legend()
plt.grid(True)
plt.show()

# æ•°å€¤è¨ˆç®—ã¨ç†è«–å€¤ã®å·®ã®æœ€å¤§å€¤ã‚’ç¢ºèª
max_diff = np.max(np.abs(np.array(g_numerical) - g_theoretical))
print(f"Maximum difference between numerical and theoretical: {max_diff:.6f}")
```

![](https://storage.googleapis.com/zenn-user-upload/e267c65bc05a-20241121.png)

## è¨¼æ˜1

å¤‰æ•°å¤‰æ›ã‚’ç”¨ã„ãŸè¨¼æ˜ã€‚

$u = x + y$, $v=x$ ã¨ã„ã†å¤‰æ•°å¤‰æ›ã‚’è€ƒãˆã‚‹ã€‚
ã“ã®ã¨ã $x=v, y = u - v$ ã¨ãªã‚‹ã€‚

ãƒ¤ã‚³ãƒ“ã‚¢ãƒ³ã‚’æ±‚ã‚ã‚‹ã¨

$$
J = \begin{vmatrix} 
\frac{\partial x}{\partial w} & \frac{\partial x}{\partial z} \\
\frac{\partial y}{\partial w} & \frac{\partial y}{\partial z}
\end{vmatrix}
= \begin{vmatrix}
1 & 0 \\
-1 & 1
\end{vmatrix}
= 1
$$

ã‚ˆã£ã¦ $|J| = 1$ã€‚

$(X, Y)$ ã®åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ã¯ $f(x, y)$ ã§ã€ $X,Y$ ã¯ç‹¬ç«‹ãªã®ã§ $f(x, y) = f_{X}(x)f_{Y}(y)$ ã¨è¡¨ã›ã‚‹ã€‚\
ã‚†ãˆã« $(U, V)$ ã®åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ã¯$g(u, v) = f(v, u - v)|J| = f_{X}(v)f_{Y}(u - v)$ã€‚\
ã“ã®ã¨ã $U$ ã®ç¢ºç‡å¯†åº¦é–¢æ•° $g(u)$ ã¯

$$
g(u) = \int_{-\infty}^{+\infty}g(u, v)dv = \int_{-\infty}^{+\infty}f_{X}(v)f_{Y}(u - v)dv
$$

## è¨¼æ˜2

ç¢ºç‡å¯†åº¦é–¢æ•°ã‹ã‚‰å°å‡ºã™ã‚‹æ–¹æ³•ã€‚

$U$ ã®ç¢ºç‡åˆ†å¸ƒé–¢æ•° $G(u)$ ã¯

$$
G(u) = P(U \le u) = P(X + Y \le u) = \iint_{x + y \le u} f(x, y)dxdy = \int_{-\infty}^{+\infty}\!\!\!\biggl\{\int_{-\infty}^{u-x}f(x, y)dy\biggr\}dx
$$

ä¸¡è¾ºã‚’ $u$ ã§å¾®åˆ†ã™ã‚‹ã¨

$(å·¦è¾º) = \frac{d}{du}G(u) = g(u)$

$(å³è¾º) = \int_{-\infty}^{+\infty}f(x, u-x)dx$

ã¨ãªã‚‹ã€‚ $X, Y$ ã¯ç‹¬ç«‹ãªã®ã§ $f(x, y) = f_{X}(x)f_{Y}(y)$ã€ã‚ˆã£ã¦ä¸ãˆã‚‰ã‚ŒãŸå¼ãŒæˆã‚Šç«‹ã¤ã€‚